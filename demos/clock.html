<!DOCTYPE html>
<html >
<head>
  <meta charset="UTF-8">
  <title>Canvallax: Clock</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="demos.css">

  <style type="text/css">
  /* Custom Styles for test */

  </style>
</head>
<body>

<script src='../dist/canvallax.js'></script>
<script>
/* Test Code */

var scene = canvallax.Scene({
      tracker: canvallax.TrackScroll(),
      fullscreen: true,
      transformOrigin: 'center center',
    }),
    width = document.body.clientWidth,
    height = document.body.clientHeight;

canvallax.clockNumbers = canvallax.createElement({

  draw: function(ctx,coords) {
    var ang;
    var num;
    var radius = (this.width/4)+(this.height/4);

    var spacing = radius*0.85;

    ctx.font = radius*0.15 + "px arial";
    ctx.textBaseline = "middle";
    ctx.textAlign = "center";

    ctx.translate(coords[0] + radius, coords[1] + radius);
    for(num= 1; num < 13; num++){
        ang = num * Math.PI / 6;
        ctx.rotate(ang);
        ctx.translate(0, -spacing);
        ctx.rotate(-ang);
        ctx.fillText(num.toString(), 0, 0);
        ctx.rotate(ang);
        ctx.translate(0, spacing);
        ctx.rotate(-ang);
    }
  }

});


var clock = canvallax.Group({
              x: (width / 2) - 50,
              y: (height / 2) - 150,
              transformOrigin: [50, 50],
              zIndex: 5,
              scale: 2
            });

var hours = canvallax.Rectangle({
      y: 20,
      x: 48,
      width: 4,
      height: 30,
      fill: '#000',
      transformOrigin: [2,30]
    }),

    minutes = canvallax.Rectangle({
      y: 10,
      x: 48.5,
      width: 3,
      height: 40,
      fill: '#000',
      transformOrigin: [1.5,40]
    }),

    seconds = canvallax.Rectangle({
      y: 5,
      x: 49,
      width: 2,
      height: 45,
      fill: '#F00',
      transformOrigin: [1,45]
    });

clock.add(

  // Clock frame
  canvallax.Ellipse({
    width: 100,
    height: 100,
    fill: '#FFF',
    stroke: '#000',
    lineWidth: 5
  }),

  // Numbers
  canvallax.clockNumbers({
    fill: '#000',
    x: 2.75,
    y: 2.75,
    width: 96,
    height: 96,
  }),

  hours,
  minutes,
  seconds,

  // Center dot
  canvallax.Ellipse({
    x: 47,
    y: 47,
    width: 6,
    height: 6,
    fill: '#000'
  })

);


//clock.to(2,{ scale: 2 },{ ease: canvallax.ease.inOutCubic, repeat: -1, yoyo: true })
function updateClock(){
  var d = new Date();
  seconds.rotation = (d.getSeconds() / 59) * 360;
  minutes.rotation = (d.getMinutes() / 59) * 360;
  hours.rotation = ((d.getHours() % 12) / 11) * 360;
}
updateClock();

clock.preRender = updateClock;

scene.add(clock);


////////////////////////////////////////


var clock2 = clock.clone({ y: clock.y + 250, preRender: null });

var secondsClone = clock2[4],
    minutesClone = clock2[3],
    hoursClone = clock2[2];

secondsClone.to(60,{ rotation: secondsClone.rotation + 360 },{ ease: canvallax.ease.linear, repeat: -1 });
minutesClone.to(3600,{ rotation: minutesClone.rotation + 360 },{ ease: canvallax.ease.linear, repeat: -1 });
hoursClone.to(86400,{ rotation: hoursClone.rotation + 360 },{ ease: canvallax.ease.linear, repeat: -1 });

scene.add(clock2);


</script>
</body>
</html>
